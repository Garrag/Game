window.__require=function t(e,o,n){function r(c,p){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var a="function"==typeof __require&&__require;if(!p&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return r(e[c][1][t]||t)},u,u.exports,t,e,o,n)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<n.length;c++)r(n[c]);return r}({AnimCpt:[function(t,e,o){"use strict";cc._RF.push(e,"a8d279MOnZL2ZC4+G4XaKPO","AnimCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.start=function(){var t=this,e=this.getComponent(cc.Animation);e&&e.play(),e.on("finished",function(){t.node.destroy()},this)},e.prototype.onPlay=function(){},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],AnimSystem:[function(t,e,o){"use strict";cc._RF.push(e,"a124dRJxYRAZomzWH5ilekN","AnimSystem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function c(t){try{s(n.next(t))}catch(e){i(e)}}function p(t){try{s(n.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(c,p)}s((n=n.apply(t,e||[])).next())})},p=this&&this.__generator||function(t,e){var o,n,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function p(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(p){i=[6,p],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0});var s=t("./System"),a=cc._decorator,u=a.ccclass,f=(a.property,a.menu),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.playSkePrefab=function(t){return c(this,void 0,void 0,function(){return p(this,function(){return t=t||{},[2,new Promise(function(e){var o=t.prefab,n=t.parent,r=t.position,i=t.scale,c=t.animName,p=t.zIndex,s=t.timeScale,a=t.preCallback,u=t.endCallback||t.callback;if(n){var f=cc.instantiate(o);f.parent=n,f.zIndex=p||1e3,r&&(f.position=r),i&&(Array.isArray(i)?(f.scaleX=i[0],f.scaleY=i[1]):f.scale=i);var l=f.getComponent(sp.Skeleton);s&&(l.timeScale=s),(l=l||f.getComponentInChildren(sp.Skeleton)).setCompleteListener(function(){u&&u(f),f.destroy(),e()}),c&&(a&&a(f),l.setAnimation(0,c,!1))}else e()})]})})},e.prototype.playSkePrefabs=function(t){return c(this,void 0,void 0,function(){var e,o;return p(this,function(n){switch(n.label){case 0:e=0,n.label=1;case 1:return e<t.length?(o=t[e],e>=t.length-1?[4,this.playSkePrefab(o)]:[3,3]):[3,5];case 2:return n.sent(),[3,4];case 3:this.playSkePrefab(o),n.label=4;case 4:return e++,[3,1];case 5:return[2]}})})},i([u,f("ECS/\u7cfb\u7edf/\u52a8\u753b\u7cfb\u7edf")],e)}(s.default);o.default=l,cc._RF.pop()},{"./System":"System"}],AudioCfgCpt:[function(t,e,o){"use strict";cc._RF.push(e,"61fccHC8Y5MKqmJs9/1JcgJ","AudioCfgCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.AudioCfgItem=void 0;var c=cc._decorator,p=c.ccclass,s=c.property,a=c.menu,u=function(){function t(){this.key="",this.audio=null}return i([s({displayName:"Key"})],t.prototype,"key",void 0),i([s({type:cc.AudioClip,displayName:"MP3"})],t.prototype,"audio",void 0),i([p("AudioCfgItem")],t)}();o.AudioCfgItem=u;var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.config=[],e}return r(e,t),i([s({type:[u]})],e.prototype,"config",void 0),i([p,a("ECS/\u914d\u7f6e/\u58f0\u97f3\u914d\u7f6e")],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],BrickCpt:[function(t,e,o){"use strict";cc._RF.push(e,"d27b77KET5Npbp2EufTvj7f","BrickCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.BrickState=void 0;var c,p=t("./BrickInfoCpt"),s=cc._decorator,a=s.ccclass,u=s.property;(function(t){t.check="check",t.droping="drop",t.fixing="fix",t.drag="drag"})(c=o.BrickState||(o.BrickState={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state=c.check,e.mapCpt=null,e.mapItem=null,e.isBoom=!1,e.isReady=!1,e.dragMoving=!1,e.touchNode=null,e.vec=cc.v3(0,-1e3),e.frameCount=0,e.fixTime=0,e}return r(e,t),Object.defineProperty(e.prototype,"touchBox",{get:function(){return this.touchNode.getBoundingBoxToWorld()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.getComponent(p.default).id},enumerable:!1,configurable:!0}),e.prototype.updatePos=function(){this.node.position=this.mapItem.node.position},i([u(cc.Node)],e.prototype,"touchNode",void 0),i([a],e)}(cc.Component);o.default=f,cc._RF.pop()},{"./BrickInfoCpt":"BrickInfoCpt"}],BrickInfoCpt:[function(t,e,o){"use strict";cc._RF.push(e,"653cfDG27JBIbwCFDgHMrcE","BrickInfoCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id=0,e.timeProgressBar=null,e.debugLabel=null,e.bgSprite=null,e.iconSprite=null,e.lifeLabel=null,e}return r(e,t),Object.defineProperty(e.prototype,"debugText",{set:function(t){this.debugLabel.string=t},enumerable:!1,configurable:!0}),e.prototype.loadConfig=function(t){this.id=t.id,this.debugText=t.name},Object.defineProperty(e.prototype,"color",{set:function(t){this.bgSprite.node.color=t},enumerable:!1,configurable:!0}),i([s],e.prototype,"id",void 0),i([s(cc.ProgressBar)],e.prototype,"timeProgressBar",void 0),i([s(cc.Label)],e.prototype,"debugLabel",void 0),i([s(cc.Sprite)],e.prototype,"bgSprite",void 0),i([s(cc.Sprite)],e.prototype,"iconSprite",void 0),i([s(cc.Label)],e.prototype,"lifeLabel",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],BtnEvtCpt:[function(t,e,o){"use strict";cc._RF.push(e,"165e40IayFO1Zy9FoEUV5WV","BtnEvtCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Event/EventManager"),p=cc._decorator,s=p.ccclass,a=p.property,u=p.menu,f=p.requireComponent,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="event_key",e.isPress=!1,e.longPressKey="event_key",e.longPressTime=2,e.longPressAnimPrefab=null,e._isPressTouch=!1,e}return r(e,t),e.prototype.onLoad=function(){var t=this,e=function(){t.unschedule(o),t._isPressTouch=!0,cc.isValid(t.pressAnimNode)||t.pressAnimNode.destroy(),c.default.inst.dispatch(t.longPressKey,t.node.getComponent(cc.Button))},o=function(){t.longPressAnimPrefab&&(t.pressAnimNode=cc.instantiate(t.longPressAnimPrefab),t.pressAnimNode.parent=t.node)};this.node.on(cc.Node.EventType.TOUCH_START,function(){if(!t.getComponent(cc.Button).interactable)return!1;t._isPressTouch=!1,t.isPress&&(t.scheduleOnce(o,.2),t.scheduleOnce(e,t.longPressTime))}),this.node.on(cc.Node.EventType.TOUCH_END,function(){if(!t.getComponent(cc.Button).interactable)return!1;t.isPress&&(t.unschedule(o),cc.isValid(t.pressAnimNode)&&t.pressAnimNode.destroy(),t.unschedule(e)),t._isPressTouch||c.default.inst.dispatch(t.key,t.node.getComponent(cc.Button)),t._isPressTouch=!1}),this.node.on(cc.Node.EventType.TOUCH_CANCEL,function(){if(!t.getComponent(cc.Button).interactable)return!1;t.isPress&&(t.unschedule(o),cc.isValid(t.pressAnimNode)&&t.pressAnimNode.destroy(),t.unschedule(e))})},i([a],e.prototype,"key",void 0),i([a(cc.Boolean)],e.prototype,"isPress",void 0),i([a({visible:function(){return 1==this.isPress}})],e.prototype,"longPressKey",void 0),i([a({visible:function(){return 1==this.isPress}})],e.prototype,"longPressTime",void 0),i([a({type:cc.Prefab,visible:function(){return 1==this.isPress}})],e.prototype,"longPressAnimPrefab",void 0),i([s,u("ECS/\u53d1\u5c04\u5668/\u6309\u94ae\u53d1\u5c04\u5668"),f(cc.Button)],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../Event/EventManager":"EventManager"}],ButtonEventCpt:[function(t,e,o){"use strict";cc._RF.push(e,"e059fYHEfZGjKfD5jpJww7h","ButtonEventCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Event/EventManager"),p=cc._decorator,s=p.ccclass,a=p.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="event_key",e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.node.on("click",function(){c.default.inst.dispatch(t.key)},this)},i([a],e.prototype,"key",void 0),i([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../Event/EventManager":"EventManager"}],CardBaseCpt:[function(t,e,o){"use strict";cc._RF.push(e,"816b6Wt3zpJOYJNwEjnTMYL","CardBaseCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layout=null,e._canTouch=!1,e}return r(e,t),Object.defineProperty(e.prototype,"layout",{get:function(){return this._layout},set:function(t){var e=this;this._layout&&(this._layout.list=this._layout.list.filter(function(t){return t!==e})),this._layout=t,this._layout.list.push(this)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canTouch",{get:function(){return this._canTouch},set:function(t){this._canTouch=t,t?(this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)):(this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this))},enumerable:!1,configurable:!0}),e.prototype.onTouchStart=function(){},e.prototype.onTouchMove=function(){},e.prototype.onTouchEnd=function(){},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],CardLayoutCpt:[function(t,e,o){"use strict";cc._RF.push(e,"ee3e9fVfyZGPIVJtr2YqFda","CardLayoutCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e.list=[],e.padding=0,e.cirPoint=null,e}return r(e,t),e.prototype.getAttrTByLayout=function(t,e){e=e||{};var o=this.list.indexOf(t),n=this.list.length,r=this.node.convertToWorldSpaceAR(this.cirPoint),i=t.node.parent.convertToNodeSpaceAR(r),c=this.padding*Math.PI/180,p=cc.Vec2.ZERO.sub(this.cirPoint);return p.rotateSelf(c*(.5*(n-1)-o)),e.rotate=180*p.signAngle(cc.Vec2.UP)/Math.PI,e.pos=i.add(p),e.zIndex=o,e},e.prototype.updateView=function(){for(var t=0,e=this.list;t<e.length;t++){var o=e[t];if(o){o.node.stopAllActions();var n=this.getAttrTByLayout(o);null!=n.scale&&(o.node.scale=n.scale),null!=n.pos&&o.node.setPosition(n.pos),null!=n.pos&&(o.node.angle=-n.rotate),null!=n.zIndex&&(o.node.zIndex=n.zIndex)}}},e.prototype.removeRandomCard=function(){return this.list.length<=0?null:this.list.splice(Math.floor(Math.random()*this.list.length),1)[0]},i([s],e.prototype,"key",void 0),i([s],e.prototype,"padding",void 0),i([s(cc.Vec2)],e.prototype,"cirPoint",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],CardTownGameWorld:[function(t,e,o){"use strict";cc._RF.push(e,"81601vVbidN36bH4sNDXkkD","CardTownGameWorld");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../Lemon/Script/ECS/World"),p=t("../../Lemon/Script/Event/EventCpt"),s=t("./CardBaseCpt"),a=t("./CardLayoutCpt"),u=t("./MoraleCpt"),f=cc._decorator,l=f.ccclass,h=f.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.morale=0,e.allCards=[],e}return r(e,t),e.prototype.onInit=function(){this.eventCpt=this.addComponent(p.default),this.moraleCpt=this.getCpt(u.default),this.handLayout=this.getCptByKey(a.default,"hand"),this.readyLayout=this.getCptByKey(a.default,"ready"),this.usedLayout=this.getCptByKey(a.default,"used");for(var t=0;t<10;t++){var e=cc.instantiate(this.getPrefab("CardBase"));e.parent=this.node;var o=e.getComponent(s.default);o.layout=this.readyLayout,this.allCards.push(o)}this.readyLayout.updateView(),this.moraleCpt.morale=5,this.eventCpt.on("card_touch_start",function(){}),this.eventCpt.on("card_touch_end",function(){})},e.prototype.start=function(){this.nextBout(4)},e.prototype.nextBout=function(t){if(this.moraleCpt.morale--,this.moraleCpt.morale>0){if(this.readyLayout.list.length<t)for(var e=0,o=this.usedLayout.list;e<o.length;e++)o[e].layout=this.readyLayout;this.readyLayout.updateView();for(var n=0;n<t;n++){var r=this.readyLayout.removeRandomCard();r.canTouch=!0,r&&(r.layout=this.handLayout)}this.readyLayout.updateView(),this.handLayout.updateView()}else cc.log("Over !")},i([h],e.prototype,"morale",void 0),i([l],e)}(c.default);o.default=d,cc._RF.pop()},{"../../Lemon/Script/ECS/World":"World","../../Lemon/Script/Event/EventCpt":"EventCpt","./CardBaseCpt":"CardBaseCpt","./CardLayoutCpt":"CardLayoutCpt","./MoraleCpt":"MoraleCpt"}],DialogCpt:[function(t,e,o){"use strict";cc._RF.push(e,"04a6e2sf29Cs6ZasES1qzTK","DialogCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.contentLabel=null,e._content="",e.okButton=null,e}return r(e,t),Object.defineProperty(e.prototype,"content",{get:function(){return this._content},set:function(t){this._content=t,this.contentLabel&&(this.contentLabel.string=t)},enumerable:!1,configurable:!0}),i([s(cc.Label)],e.prototype,"contentLabel",void 0),i([s(cc.Button)],e.prototype,"okButton",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],DropEffectCpt:[function(t,e,o){"use strict";cc._RF.push(e,"b9446z2ra5H77XDZ7Oik50W","DropEffectCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.floor=0,e.velocity=cc.Vec3.ZERO,e.gravity=cc.v3(0,-100),e.isMoving=!1,e}return r(e,t),e.prototype.start=function(){},e.prototype.update=function(t){this.isMoving||(this.velocity.addSelf(this.gravity),this.node.position=this.node.position.add(this.velocity.mul(t)),this.node.position.y<this.floor&&(this.velocity.x*=.8,this.velocity.y*=-.8,this.node.position=cc.v3(this.node.position.x,this.floor)))},e.prototype.toEnd=function(t){var e,o=this,n=(t=t||{}).toPos,r=t.delay||0,i=t.callback,c=t.animTime||1,p=n.sub(this.node.position);e=p.x>0?p.mul(.7*Math.random()).add(p.rotate(90).normalize().mul(400*Math.random())):p.mul(.7*Math.random()).add(p.rotate(-90).normalize().mul(400*Math.random()));var s=[this.node.position,e,n];this.node.runAction(cc.sequence(cc.delayTime(r),cc.callFunc(function(){o.isMoving=!0}),cc.bezierTo(c,s).easing(cc.easeSineIn()),cc.callFunc(function(){i&&i()}),cc.removeSelf()))},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],EventCpt:[function(t,e,o){"use strict";cc._RF.push(e,"fa276y24J5NRLWBgV8tAAcZ","EventCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./EventManager"),p=cc._decorator,s=p.ccclass,a=(p.property,p.menu),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._events=[],e}return r(e,t),e.prototype.onLoad=function(){this._eventManager=c.default.inst},e.prototype.on=function(t,e,o){var n=this._eventManager.on(t,e,o);return this._events.push(n),n},e.prototype.once=function(t,e,o){var n=this._eventManager.once(t,e,o);return this._events.push(n),n},e.prototype.off=function(t){this._eventManager.off(t);for(var e=this._events.length-1;e>=0;e--)if(t===this._events[e]){this._events.splice(e,1);break}},e.prototype.removeAll=function(){for(var t=0;t<this._events.length;t++){var e=this._events[t];this._eventManager.off(e)}this._events=[]},e.prototype.dispatch=function(t,e,o,n,r,i){this._eventManager.dispatch(t,e,o,n,r,i)},e.prototype.onDestroy=function(){this.removeAll()},i([s,a("\u4e8b\u4ef6/\u4e8b\u4ef6\u7ec4\u4ef6")],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./EventManager":"EventManager"}],EventManager:[function(t,e,o){"use strict";cc._RF.push(e,"f224bh1NClHLZobujFKpJZO","EventManager"),Object.defineProperty(o,"__esModule",{value:!0}),o.EventObject=void 0;var n=function(t,e,o,n){this.type=t,this.callback=e,this.target=o,this.callOnce=n};o.EventObject=n;var r=function(){function t(){this._pool={},this._eventTarget=new cc.EventTarget}return Object.defineProperty(t,"inst",{get:function(){return this._inst||(this._inst=new t),this._inst},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t,e,o,r){var i=this;void 0===r&&(r=!1);var c=new n(t,e,o,r);return this._pool[t]||(this._pool[t]=[],this._eventTarget.on(t,function(e,o,n,r,c){i._onListener(t,e,o,n,r,c)},this)),this._pool[t].push(c),c},t.prototype.on=function(t,e,o){return this.addListener(t,e,o,!1)},t.prototype.once=function(t,e,o){return this.addListener(t,e,o,!0)},t.prototype._onListener=function(t,e,o,n,r,i){for(var c=this._pool[t],p=0,s=c.length;p<s;){var a=c[p],u=a.target;a.callback&&a.callback.call(u,e,o,n,r,i),a.callOnce&&(c.splice(p,1),p--,s--),p++}},t.prototype.off=function(t){if(t){for(var e=this._pool[t.type],o=e.length-1;o>=0;o--)if(t===e[o])return e.splice(o,1),!0;return!1}},t.prototype.removeAll=function(){var t=this;for(var e in this._pool)this._pool[e].forEach(function(e){t.off(e)})},t.prototype.dispatch=function(t,e,o,n,r,i){this._eventTarget.emit(t,e,o,n,r,i)},t._inst=null,t}();o.default=r,cc._RF.pop()},{}],FSM:[function(t,e,o){"use strict";cc._RF.push(e,"3cb1eCxuqZCEYNKa6oymQBe","FSM");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.stateList=[],e.currentStateData=null,e.nextStateName="",e}return r(e,t),Object.defineProperty(e.prototype,"currentState",{get:function(){return this.currentStateData.state},enumerable:!1,configurable:!0}),e.prototype.addState=function(t,e,o,n){this.stateList.push({state:t,onStartFunc:e,onUpdateFunc:o,onEndFunc:n})},e.prototype.update=function(){for(var t=null,e=0,o=this.stateList;e<o.length;e++){var n=o[e];this.nextStateName==n.state&&(t=n)}this.nextStateName="",t&&(this.currentStateData&&this.currentStateData.onEndFunc&&this.currentStateData.onEndFunc(this),this.currentStateData=t,t.onStartFunc&&t.onStartFunc(this)),this.currentStateData&&this.currentStateData.onUpdateFunc&&this.currentStateData.onUpdateFunc(this)},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],GameConfigCpt:[function(t,e,o){"use strict";cc._RF.push(e,"58c6fr7qxlNrphi/gfBLHrO","GameConfigCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.brickJson=null,e.roleJson=null,e}return r(e,t),Object.defineProperty(e.prototype,"brickConfig",{get:function(){return this.brickJson.json},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroConfig",{get:function(){return{id:1e3,name:"hero",info:""}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"roleConfig",{get:function(){return this.roleJson.json},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"heroBaseConfig",{get:function(){for(var t=0,e=this.roleConfig;t<e.length;t++){var o=e[t];if(1==o.id)return o}},enumerable:!1,configurable:!0}),e.prototype.getMonsterConfigByLevel=function(){for(var t=0,e=this.roleConfig;t<e.length;t++){var o=e[t];if(1001==o.id)return o}},e.prototype.getBrickConfig=function(t){for(var e=0,o=this.brickConfig;e<o.length;e++){var n=o[e];if(n.id==t)return n}},i([s(cc.JsonAsset)],e.prototype,"brickJson",void 0),i([s(cc.JsonAsset)],e.prototype,"roleJson",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],GameMapCpt:[function(t,e,o){"use strict";cc._RF.push(e,"3e55drDLGFETYEfAheYJ6B5","GameMapCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c},c=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))(function(r,i){function c(t){try{s(n.next(t))}catch(e){i(e)}}function p(t){try{s(n.throw(t))}catch(e){i(e)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof o?e:new o(function(t){t(e)})).then(c,p)}s((n=n.apply(t,e||[])).next())})},p=this&&this.__generator||function(t,e){var o,n,r,i,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function p(t){return function(e){return s([t,e])}}function s(i){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,n&&(r=2&i[0]?n.return:i[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,i[1])).done)return r;switch(n=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(r=(r=c.trys).length>0&&r[r.length-1])&&(6===i[0]||2===i[0])){c=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){c.label=i[1];break}if(6===i[0]&&c.label<r[1]){c.label=r[1],r=i;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(i);break}r[2]&&c.ops.pop(),c.trys.pop();continue}i=e.call(t,c)}catch(p){i=[6,p],n=0}finally{o=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}};Object.defineProperty(o,"__esModule",{value:!0}),o.GameMapState=void 0;var s,a=t("./GameMapItem"),u=t("./BrickCpt"),f=t("../../Lemon/Script/FSM/FSM"),l=t("../../Lemon/Script/Tools"),h=t("./BrickInfoCpt"),d=t("../../Lemon/Script/Event/EventManager"),y=cc._decorator,_=y.ccclass,v=y.property;(function(t){t.idel="idel",t.filling="filling",t.handling="handling",t.waiting="waiting"})(s=o.GameMapState||(o.GameMapState={}));var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.row=0,e.col=0,e.itemW=0,e.itemH=0,e.graphics=null,e.mapItemPrefab=null,e.brickPrefab=null,e._lineBricks=[],e.brickConfig=[],e.map=new Array,e.brickList=new Array,e}return r(e,t),Object.defineProperty(e.prototype,"active",{set:function(t){for(var e=0,o=this.brickList;e<o.length;e++)o[e].node.active=t;for(var n=0;n<this.row;n++)for(var r=0;r<this.col;r++)this.map[n][r].node.active=t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){this.graphics.node.zIndex=1e3,this.initMap(),this.initFsm()},e.prototype.initMap=function(){for(var t=0;t<this.row;t++){this.map[t]=new Array;for(var e=0;e<this.col;e++){var o=cc.instantiate(this.mapItemPrefab);o.parent=this.node,o.position=cc.v3(cc.v3((-.5*(this.row-1)+t)*this.itemW,(.5*-(this.col-1)+e)*this.itemH)).add(this.node.position);var n=o.getComponent(a.default);this.map[t][e]=n}}for(var r=0;r<this.row;r++)for(var i=0;i<this.col;i++){var c=this.map[r][i];c.up=this.map[r][i+1],c.down=this.map[r][i-1],this.map[r-1]&&(c.left=this.map[r-1][i],c.leftUp=this.map[r-1][i+1],c.leftDown=this.map[r-1][i-1]),this.map[r+1]&&(c.right=this.map[r+1][i],c.rightUp=this.map[r+1][i+1],c.rightDown=this.map[r+1][i-1])}},e.prototype.initFsm=function(){var t=this;this.fsm=this.addComponent(f.default),this.fsm.addState(s.idel,null,null,null),this.fsm.addState(s.filling,function(e){return c(t,void 0,void 0,function(){var t,o,n,r,i,c,a,u;return p(this,function(p){switch(p.label){case 0:for(t=[],o=function(t){return t.brick&&t.down&&!t.down.brick?(t.down.brick=t.brick,t.brick=null,o(t.down)):t},n=0;n<this.col;n++)for(r=0;r<this.row;r++)(i=o(this.map[r][n]))!=this.map[r][n]&&t.push(i);for(c=0,a=t;c<a.length;c++)u=a[c],cc.tween(u.brick.node).to(.2,{position:u.node.position}).start();return[4,l.default.delay(this,this.fillBricks())];case 1:return p.sent(),e.nextStateName=s.waiting,[2]}})})},null,null),this.fsm.addState(s.waiting,function(){t.node.on(cc.Node.EventType.TOUCH_START,t.onTouchStartCallback,t,!0),t.node.on(cc.Node.EventType.TOUCH_MOVE,t.onTouchMoveCallback,t,!0),t.node.on(cc.Node.EventType.TOUCH_END,t.onTouchEndCallback,t,!0),t.node.on(cc.Node.EventType.TOUCH_CANCEL,t.onTouchEndCallback,t,!0)},null,function(){t.node.off(cc.Node.EventType.TOUCH_START,t.onTouchStartCallback,t,!0),t.node.off(cc.Node.EventType.TOUCH_MOVE,t.onTouchMoveCallback,t,!0),t.node.off(cc.Node.EventType.TOUCH_END,t.onTouchEndCallback,t,!0),t.node.off(cc.Node.EventType.TOUCH_CANCEL,t.onTouchEndCallback,t,!0)}),this.fsm.addState(s.handling,function(e){return c(t,void 0,void 0,function(){var t,o,n,r,i;return p(this,function(c){switch(c.label){case 0:if(this._lineBricks.length<=1)return e.nextStateName=s.waiting,[2];t=this._lineBricks.shift(),o=0,n=this._lineBricks,c.label=1;case 1:return o<n.length?(r=n[o],i=r.mapItem,d.default.inst.dispatch("bricks_boom",t,r),this.removeBrick(i),cc.tween(t.node).to(.1,{position:r.node.position}).start(),t.mapItem.brick=null,i.brick=t,t.updatePos(),[4,l.default.delay(this,.2)]):[3,4];case 2:c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return d.default.inst.dispatch("game_next"),e.nextStateName=s.filling,[2]}})})},null,null),this.clear()},e.prototype.run=function(t,e){return c(this,void 0,void 0,function(){var o,n;return p(this,function(r){switch(r.label){case 0:return this.brickConfig=e,this.clear(),(o=cc.instantiate(this.brickPrefab)).parent=this.node,o.position=cc.v3(0,0,0),n=o.getComponent(u.default),o.getComponent(h.default).loadConfig(t),o.getComponent(h.default).color=cc.color(255,0,255),this.addBrick(n,this.map[2][2]),[4,l.default.delay(this,this.fillBricks())];case 1:return r.sent(),this.fsm.nextStateName=s.waiting,[2]}})})},e.prototype.clear=function(){this.fsm.nextStateName=s.idel;for(var t=0;t<this.col;t++)for(var e=0;e<this.row;e++)if(this.map[e][t].brick){var o=this.map[e][t].brick;this.map[e][t].brick=null,o.node.destroy()}},e.prototype.fillBricks=function(){for(var t=0,e=0;e<this.col;e++)for(var o=function(o){if(!n.map[o][e].brick){var r=n.getBrickByPool();n.addBrick(r,n.map[o][e]),r.node.scale=.1,r.node.position=n.map[o][e].node.position;var i=cc.sequence(cc.delayTime(.02*t++),cc.spawn(cc.scaleTo(.1,1),cc.rotateBy(.1,1080)),cc.callFunc(function(){r.node.angle=0,r.updatePos()}));r.node.runAction(i)}},n=this,r=0;r<this.row;r++)o(r);return.05*t},e.prototype.onTouchStartCallback=function(t){this._lineBricks=[];for(var e=0,o=this.brickList;e<o.length;e++){var n=o[e];n.touchBox.contains(t.getLocation())&&1e3==n.id&&this._lineBricks.push(n)}},e.prototype.onTouchMoveCallback=function(t){if(!(this._lineBricks.length<=0)){for(var e=this._lineBricks[0],o=this._lineBricks[this._lineBricks.length-1],n=this._lineBricks[this._lineBricks.length-2],r=null,i=0,c=this.brickList;i<c.length;i++){var p=c[i];if(p.touchBox.contains(t.getLocation())){r=p;break}}if(r&&o!=r){this._lineBricks.indexOf(r)>=0?r==n&&this._lineBricks.pop():o.mapItem.left&&o.mapItem.left.brick==r?this._lineBricks.push(r):o.mapItem.right&&o.mapItem.right.brick==r?this._lineBricks.push(r):o.mapItem.up&&o.mapItem.up.brick==r?this._lineBricks.push(r):o.mapItem.down&&o.mapItem.down.brick==r?this._lineBricks.push(r):o.mapItem.leftUp&&o.mapItem.leftUp.brick==r?this._lineBricks.push(r):o.mapItem.leftDown&&o.mapItem.leftDown.brick==r?this._lineBricks.push(r):o.mapItem.rightUp&&o.mapItem.rightUp.brick==r?this._lineBricks.push(r):o.mapItem.rightDown&&o.mapItem.rightDown.brick==r&&this._lineBricks.push(r),this.graphics.clear(),this.graphics.moveTo(e.node.position.x,e.node.position.y);for(var s=0,a=this._lineBricks;s<a.length;s++){var u=a[s];this.graphics.lineTo(u.node.position.x,u.node.position.y)}this.graphics.stroke()}}},e.prototype.onTouchEndCallback=function(){this.graphics.clear(),this.fsm.nextStateName=s.handling},e.prototype.getMapItem=function(t){for(var e=null,o=0;o<this.row;o++)for(var n=0;n<this.col;n++)this.map[o][n]&&this.map[o][n].node.getBoundingBox().contains(cc.v2(t))&&(e=this.map[o][n]);return e},e.prototype.getIdelMapItem=function(){for(var t=0;t<this.col;t++)for(var e=0;e<this.row;e++)if(!this.map[e][t].brick)return this.map[e][t]},e.prototype.addBrick=function(t,e){t.mapCpt=this,t.mapItem=e,e.brick=t,this.brickList.push(t)},e.prototype.removeBrick=function(t){var e=t.brick;t.brick=null,e.node.destroy(),this.brickList=this.brickList.filter(function(t){return e!==t})},e.prototype.getBrickByPool=function(){var t=Math.floor(Math.random()*this.brickConfig.length),e=this.brickConfig[t],o=cc.instantiate(this.brickPrefab);return o.parent=this.node,o.position=cc.v3(0,0,0),o.getComponent(h.default).loadConfig(e),1001==e.id?o.getComponent(h.default).color=cc.Color.CYAN:1002==e.id?o.getComponent(h.default).color=cc.Color.YELLOW:1003==e.id?o.getComponent(h.default).color=cc.Color.GREEN:o.getComponent(h.default).color=cc.Color.RED,o.getComponent(u.default)},i([v],e.prototype,"row",void 0),i([v],e.prototype,"col",void 0),i([v],e.prototype,"itemW",void 0),i([v],e.prototype,"itemH",void 0),i([v(cc.Graphics)],e.prototype,"graphics",void 0),i([v(cc.Prefab)],e.prototype,"mapItemPrefab",void 0),i([v(cc.Prefab)],e.prototype,"brickPrefab",void 0),i([_],e)}(cc.Component);o.default=b,cc._RF.pop()},{"../../Lemon/Script/Event/EventManager":"EventManager","../../Lemon/Script/FSM/FSM":"FSM","../../Lemon/Script/Tools":"Tools","./BrickCpt":"BrickCpt","./BrickInfoCpt":"BrickInfoCpt","./GameMapItem":"GameMapItem"}],GameMapItem:[function(t,e,o){"use strict";cc._RF.push(e,"ae32cr/We9JRYZW7AtCyo7A","GameMapItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.busySprite=null,e.cornerSprite=null,e}return r(e,t),Object.defineProperty(e.prototype,"isSelect",{get:function(){return this.busySprite.node.active},set:function(t){this.busySprite.node.active=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"brick",{get:function(){return this._brick},set:function(t){this._brick=t,t&&(t.mapItem=this)},enumerable:!1,configurable:!0}),i([s(cc.Sprite)],e.prototype,"busySprite",void 0),i([s(cc.Sprite)],e.prototype,"cornerSprite",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],GameWorld:[function(t,e,o){"use strict";cc._RF.push(e,"70d3ct8Wv1Ci44RbuWBAMTu","GameWorld");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../../Lemon/Script/ECS/World"),p=t("../../Lemon/Script/Event/EventCpt"),s=t("../../Lemon/Script/Popup/PopupManager"),a=t("./GameConfigCpt"),u=t("./GameMapCpt"),f=t("./HeroCpt"),l=t("./OprViewCpt"),h=cc._decorator,d=h.ccclass,y=(h.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isGameOver=!1,e}return r(e,t),e.prototype.onInit=function(){var t=this;this.heroCpt=this.getCpt(f.default),this.oprViewCpt=this.getCpt(l.default),this.mapCpt=this.getCpt(u.default),this.configCpt=this.getCpt(a.default),this.eventCpt=this.node.addComponent(p.default),this.eventCpt.on("bricks_boom",this.onBricksBoom.bind(this)),this.eventCpt.on("game_next",this.onWorldNext.bind(this)),this.eventCpt.on("game_test",function(){t.isGameOver=!0,s.default.inst.add(t.getPrefab("PopupGameOver"))}),this.eventCpt.on("game_restart",function(){s.default.inst.removeAll(),t.start()})},e.prototype.start=function(){this.isGameOver=!1,this.heroCpt.hp=10,this.heroCpt.feed=10,this.heroCpt.exp=0,this.mapCpt.clear(),this.mapCpt.run(this.configCpt.heroConfig,this.configCpt.brickConfig)},e.prototype.onUpdate=function(){},e.prototype.onWorldNext=function(){this.heroCpt.hp<=0&&(this.isGameOver=!0,s.default.inst.add(this.getPrefab("PopupGameOver")))},e.prototype.onBricksBoom=function(t,e){this.heroCpt.feed--,this.heroCpt.feed<0&&this.heroCpt.hp--,this.heroCpt.feed=Math.max(0,this.heroCpt.feed),this.heroCpt.hp=Math.max(0,this.heroCpt.hp),1001==e.id?this.heroCpt.feed+=3:1002==e.id?this.heroCpt.hp+=2:1003==e.id?this.heroCpt.exp+=1:1004==e.id?this.heroCpt.hp-=1:1005==e.id?this.heroCpt.hp-=2:1006==e.id&&(this.heroCpt.hp-=5)},i([d],e)}(c.default));o.default=y,cc._RF.pop()},{"../../Lemon/Script/ECS/World":"World","../../Lemon/Script/Event/EventCpt":"EventCpt","../../Lemon/Script/Popup/PopupManager":"PopupManager","./GameConfigCpt":"GameConfigCpt","./GameMapCpt":"GameMapCpt","./HeroCpt":"HeroCpt","./OprViewCpt":"OprViewCpt"}],GoldCpt:[function(t,e,o){"use strict";cc._RF.push(e,"6e0034naeNOwJoQDeais0MN","GoldCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.textLabel=null,e._gold=0,e}return r(e,t),Object.defineProperty(e.prototype,"gold",{get:function(){return this._gold},set:function(t){this._gold=t,this.textLabel&&(this.textLabel.string=t+"")},enumerable:!1,configurable:!0}),i([s(cc.Label)],e.prototype,"textLabel",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],HeroCpt:[function(t,e,o){"use strict";cc._RF.push(e,"540b4bRs8NAzY4wHnnMk+VP","HeroCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.expLabel=null,e.hpLabel=null,e.feedLabel=null,e.goldLabel=null,e._gold=0,e._exp=0,e._hp=0,e._feed=0,e}return r(e,t),Object.defineProperty(e.prototype,"gold",{get:function(){return this._gold},set:function(t){this._gold=t,this.goldLabel.string="gold: "+t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exp",{get:function(){return this._exp},set:function(t){this._exp=t,this.expLabel.string="exp: "+t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=t,this.hpLabel.string="hp: "+t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"feed",{get:function(){return this._feed},set:function(t){this._feed=t,this.feedLabel.string="feed: "+t},enumerable:!1,configurable:!0}),e.prototype.onLoad=function(){},e.prototype.update=function(){},i([s(cc.Label)],e.prototype,"expLabel",void 0),i([s(cc.Label)],e.prototype,"hpLabel",void 0),i([s(cc.Label)],e.prototype,"feedLabel",void 0),i([s(cc.Label)],e.prototype,"goldLabel",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],IdCpt:[function(t,e,o){"use strict";cc._RF.push(e,"d688aPaKmJGEK/8OIcFjhFd","IdCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="",e}return r(e,t),i([s],e.prototype,"id",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],IslandWorld:[function(t,e,o){"use strict";cc._RF.push(e,"5ef342Qis9CrL3J651i2VZq","IslandWorld");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Lemon/Script/ECS/World"),p=cc._decorator,s=p.ccclass,a=(p.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onInit=function(){},i([s],e)}(c.default));o.default=a,cc._RF.pop()},{"../Lemon/Script/ECS/World":"World"}],KeyCpt:[function(t,e,o){"use strict";cc._RF.push(e,"ee7d7MVZQ1EgZaqh3MlZ8UL","KeyCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=c.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="",e}return r(e,t),i([s],e.prototype,"key",void 0),i([p,a("ECS/key")],e)}(cc.Component);o.default=u,cc._RF.pop()},{}],MonsterCpt:[function(t,e,o){"use strict";cc._RF.push(e,"a2362OXAntCTqne+S6aqbRT","MonsterCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e}return r(e,t),e.prototype.start=function(){},i([s(cc.Label)],e.prototype,"label",void 0),i([s],e.prototype,"text",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],MoraleCpt:[function(t,e,o){"use strict";cc._RF.push(e,"59e9fgXOr9KJKQTl/2YcCI7","MoraleCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.valueLabel=null,e._morale=0,e}return r(e,t),Object.defineProperty(e.prototype,"morale",{get:function(){return this._morale},set:function(t){this._morale=t,this.valueLabel&&(this.valueLabel.string=t.toString())},enumerable:!1,configurable:!0}),e.prototype.start=function(){},i([s(cc.Label)],e.prototype,"valueLabel",void 0),i([p],e)}(cc.Component);o.default=a,cc._RF.pop()},{}],OprViewCpt:[function(t,e,o){"use strict";cc._RF.push(e,"d8bcdGYLHJGzKgzJs5MJ4w3","OprViewCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],PopupCpt:[function(t,e,o){"use strict";cc._RF.push(e,"34d848p/DhEea5oaPZOrtZ5","PopupCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=c.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.touchClose=!0,e}return r(e,t),i([s],e.prototype,"touchClose",void 0),i([p,a("\u7ec4\u4ef6/\u5f39\u7a97")],e)}(cc.Component);o.default=u,cc._RF.pop()},{}],PopupManager:[function(t,e,o){"use strict";cc._RF.push(e,"f3a11T+E5tF0JbaqqQrXwxj","PopupManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Component/PopupCpt"),r=function(){function t(){this.popupCptList=[],this.maskNode=null}return Object.defineProperty(t,"inst",{get:function(){return this._inst||(this._inst=new t),this._inst},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"topPopup",{get:function(){return this.popupCptList[this.popupCptList.length-1]},enumerable:!1,configurable:!0}),t.prototype.openMask=function(){var t=this;if(this.maskNode)return this.maskNode;this.maskNode=new cc.Node,this.maskNode.parent=cc.director.getScene();var e=this.maskNode.addComponent(cc.Graphics);e.fillColor=new cc.Color(0,0,0,155),e.fillRect(-cc.winSize.width/2,-cc.winSize.height/2,cc.winSize.width,cc.winSize.height),this.maskNode.width=cc.winSize.width,this.maskNode.height=cc.winSize.height,this.maskNode.position=cc.v3(cc.winSize.width/2,cc.winSize.height/2,0),this.maskNode.active=!0,this.maskNode.on(cc.Node.EventType.TOUCH_END,function(){t.topPopup.touchClose&&t.removeTopPopup()},this)},t.prototype.closeMask=function(){this.maskNode&&this.maskNode.destroy()},t.prototype.removeTopPopup=function(){var t=this.popupCptList.pop();t&&t.node.destroy(),this.updatePopup()},t.prototype.updatePopup=function(){if(this.popupCptList.length>0){this.openMask();for(var e=0;e<this.popupCptList.length;e++)this.popupCptList[e].node.zIndex=t.POPUP_ZINDEX+2*e,e==this.popupCptList.length-1&&(this.maskNode.zIndex=t.POPUP_ZINDEX+2*e-1)}else this.closeMask()},t.prototype.add=function(t){var e=null;t instanceof cc.Prefab?e=cc.instantiate(t):t instanceof cc.Node&&(e=t);var o=e.getComponent(n.default);o?(e.parent=cc.director.getScene(),e.position=cc.v3(cc.winSize.width/2,cc.winSize.height/2),this.popupCptList.push(o),this.updatePopup()):cc.warn("\u5f39\u51fa\u7684\u8282\u70b9\u4e0d\u5305\u542b\u5f39\u7a97\u7ec4\u4ef6!",t.name)},t.prototype.removeAll=function(){for(var t=0,e=this.popupCptList;t<e.length;t++)e[t].node.destroy();this.popupCptList=[],this.updatePopup()},t._inst=null,t.POPUP_ZINDEX=1e3,t}();o.default=r,cc._RF.pop()},{"../Component/PopupCpt":"PopupCpt"}],PopupScaleInCpt:[function(t,e,o){"use strict";cc._RF.push(e,"99797VaKFdKk6gPFv9TkSU8","PopupScaleInCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.node.scale=.01,this.node.runAction(cc.scaleTo(.15,1).easing(cc.easeQuarticActionOut()))},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],PrefabCfgCpt:[function(t,e,o){"use strict";cc._RF.push(e,"1c4c1b9jMhMFbMci7Agd/0P","PrefabCfgCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=c.property,a=c.menu,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.config=[],e}return r(e,t),i([s([cc.Prefab])],e.prototype,"config",void 0),i([p,a("ECS/\u914d\u7f6e/\u9884\u5236\u4f53\u914d\u7f6e")],e)}(cc.Component);o.default=u,cc._RF.pop()},{}],ResidentCpt:[function(t,e,o){"use strict";cc._RF.push(e,"752f4ihjihCUJ3OkBktR4ME","ResidentCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node)},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],RoleCpt:[function(t,e,o){"use strict";cc._RF.push(e,"7cfe0JwEfNI5bYlWPt00Qfz","RoleCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.RoleCamp=o.BrickConfigItem=void 0;var c,p=cc._decorator,s=p.ccclass,a=p.property,u=function(){function t(){this.id=0,this.weight=10}return i([a({type:cc.Float,displayName:"ID"})],t.prototype,"id",void 0),i([a({type:cc.Float,displayName:"\u6743\u91cd"})],t.prototype,"weight",void 0),i([s("BrickConfigItem")],t)}();o.BrickConfigItem=u,function(t){t[t.Hero=0]="Hero",t[t.Monster=1]="Monster"}(c=o.RoleCamp||(o.RoleCamp={}));var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.camp=c.Hero,e.nameLabel=null,e.hpProgress=null,e.hpLabel=null,e.speedLabel=null,e._brickConfig=[],e.config=[],e._hp=0,e.powerSpeed=25,e.strength=1,e._vit=10,e._speed=0,e}return r(e,t),Object.defineProperty(e.prototype,"brickConfig",{get:function(){return this._brickConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hp",{get:function(){return this._hp},set:function(t){this._hp=Math.min(t,this.maxHp),this.updateHp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxHp",{get:function(){return 10*this.vit},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vit",{get:function(){return this._vit},set:function(t){this._vit=t,this.updateHp()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"speed",{get:function(){return this._speed},set:function(t){this._speed=t,this.speedLabel&&(this.speedLabel.string=t.toString())},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.hp=this.maxHp},e.prototype.updateHp=function(){this.hpLabel&&(this.hpLabel.string=this.hp+"/"+this.maxHp),this.hpProgress&&(this.hpProgress.progress=this.hp/this.maxHp)},e.prototype.setBrickWeight=function(t,e){for(var o=null,n=0,r=this._brickConfig;n<r.length;n++){var i=r[n];i.id==t&&(o=i)}o?o.weight=e:this._brickConfig.push({id:t,weight:e})},e.prototype.loadConfig=function(t){this.vit=t.vit,this.strength=t.strength,this.speed=t.speed;for(var e=0,o=t.brickConfig.split(",");e<o.length;e++){var n=o[e].split(":");this.brickConfig.push({id:parseInt(n[0]),weight:parseInt(n[1])})}this.nameLabel.string=t.name},i([a(cc.Label)],e.prototype,"nameLabel",void 0),i([a(cc.ProgressBar)],e.prototype,"hpProgress",void 0),i([a(cc.Label)],e.prototype,"hpLabel",void 0),i([a(cc.Label)],e.prototype,"speedLabel",void 0),i([a([u])],e.prototype,"config",void 0),i([a],e.prototype,"powerSpeed",void 0),i([a],e.prototype,"strength",void 0),i([a],e.prototype,"_vit",void 0),i([a],e.prototype,"vit",null),i([s],e)}(cc.Component);o.default=f,cc._RF.pop()},{}],System:[function(t,e,o){"use strict";cc._RF.push(e,"5bd56hH8OhGxLGxm5JAZwHI","System");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,p=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.world=null,e}return r(e,t),e.prototype.onInit=function(){},e.prototype.onUpdate=function(){},e.prototype.getCpt=function(t,e){return this.world.getCpt(t,e)},e.prototype.getCpts=function(t,e){return this.world.getCpts(t,e)},i([p],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],TabbarEvtCpt:[function(t,e,o){"use strict";cc._RF.push(e,"446b4GcUU9E66eOA7bltbIK","TabbarEvtCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Event/EventManager"),p=cc._decorator,s=p.ccclass,a=p.property,u=p.menu,f=p.requireComponent,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="event_key",e.views=[],e}return r(e,t),e.prototype.onLoad=function(){this.toggleContainer=this.node.getComponent(cc.ToggleContainer);var t=new cc.Component.EventHandler;t.target=this.node,t.component="TabbarEvtCpt",t.handler="onClick",t.customEventData="",this.toggleContainer.checkEvents.push(t)},e.prototype.onClick=function(t){for(var e=this.toggleContainer.toggleItems.indexOf(t),o=0,n=this.views;o<n.length;o++)n[o].active=!1;this.views[e]&&(this.views[e].active=!0),c.default.inst.dispatch(this.key,e)},i([a],e.prototype,"key",void 0),i([a([cc.Node])],e.prototype,"views",void 0),i([s,u("ECS/\u53d1\u5c04\u5668/\u9009\u578b\u5361\u53d1\u5c04\u5668"),f(cc.ToggleContainer)],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../Event/EventManager":"EventManager"}],ToastManager:[function(t,e,o){"use strict";cc._RF.push(e,"426fehWAbhC55ZcSw2VAIuR","ToastManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return Object.defineProperty(t,"inst",{get:function(){return this._inst||(this._inst=new t),this._inst},enumerable:!1,configurable:!0}),t.prototype.toast=function(t,e){var o=this;e=e||cc.v3(cc.winSize.width/2,cc.winSize.height-80,0),this.toastNode&&(this.toastNode.destroy(),this.toastNode=null);var n=cc.size(300,50);this.toastNode=new cc.Node,this.toastNode.parent=cc.director.getScene();var r=this.toastNode.addComponent(cc.Graphics);r.fillColor=new cc.Color(0,0,0),r.fillRect(-n.width/2,-n.height/2,n.width,n.height),this.toastNode.position=e;var i=new cc.Node;i.parent=this.toastNode;var c=i.addComponent(cc.Label);c.string=t,c.fontSize=25,c.verticalAlign=cc.Label.VerticalAlign.CENTER,c.horizontalAlign=cc.Label.HorizontalAlign.CENTER,this.toastNode.scale=.1,this.toastNode.runAction(cc.scaleTo(.2,1).easing(cc.easeQuarticActionOut())),cc.tween(this.toastNode).delay(3).call(function(){o.toastNode&&(o.toastNode.destroy(),o.toastNode=null)}).start()},t._inst=null,t}();o.default=n,cc._RF.pop()},{}],ToggleEvtCpt:[function(t,e,o){"use strict";cc._RF.push(e,"fb6f5A7idNFtJrXJHVbBJ9s","ToggleEvtCpt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("../Event/EventManager"),p=cc._decorator,s=p.ccclass,a=p.property,u=p.menu,f=p.requireComponent,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.key="event_key",e}return r(e,t),e.prototype.onLoad=function(){var t=this;this.node.on("toggle",function(){c.default.inst.dispatch(t.key,t.node.getComponent(cc.Toggle))},this)},i([a],e.prototype,"key",void 0),i([s,u("ECS/\u53d1\u5c04\u5668/\u5f00\u5173\u53d1\u5c04\u5668"),f(cc.Toggle)],e)}(cc.Component);o.default=l,cc._RF.pop()},{"../Event/EventManager":"EventManager"}],Tools:[function(t,e,o){"use strict";cc._RF.push(e,"24782U/bgNB45ePWiQ8pmim","Tools"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.getPromise=function(t,e){var o;return{promise:new Promise(function(e,n){o=n,t(e,n)}),abort:function(){e&&e(),o({message:"the promise is aborted"})}}},t.delay=function(e,o,n){var r=t.getPromise(function(t){e.scheduleOnce(function(){t()},o)}),i=r.promise,c=r.abort;return n&&n.push(c),i},t}();o.default=n,cc._RF.pop()},{}],World:[function(t,e,o){"use strict";cc._RF.push(e,"f63d1acW7NHU5HvsiAfmwVA","World");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,c=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var p=t.length-1;p>=0;p--)(r=t[p])&&(c=(i<3?r(c):i>3?r(e,o,c):r(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./System"),p=t("./KeyCpt"),s=t("./PrefabCfgCpt"),a=cc._decorator,u=a.ccclass,f=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.timeScale=1,e.systemList=[],e}return r(e,t),e.prototype.onLoad=function(){this.systemList=this.systemList.concat(this.node.getComponentsInChildren(c.default));for(var t=0,e=this.systemList;t<e.length;t++){var o=e[t];cc.log("\u6302\u8f7dSystem : ",o.name),o.world=this,o.onInit()}this.onInit()},e.prototype.onInit=function(){},e.prototype.update=function(t){t*=this.timeScale,this.onUpdate(t);for(var e=0,o=this.systemList;e<o.length;e++)o[e].onUpdate(t)},e.prototype.getSystem=function(t){var e=this.node.getComponent(t);return e||(e=cc.find("InitBase").getComponent(t)),e||(e=this.node.getComponentInChildren(t)),e},e.prototype.getCpt=function(t,e){return this.getCpts(t,e)[0]},e.prototype.getCpts=function(t,e){for(var o=[],n=0,r=cc.director.getScene().getComponentsInChildren(t);n<r.length;n++){var i=r[n];e?e(i)&&o.push(i):o.push(i)}return o},e.prototype.onUpdate=function(){},e.prototype.getCptByKey=function(t,e){return this.getCpt(t,function(t){var o=t.getComponent(p.default);return!(!o||o.key!=e)||!(!t.key||t.key!=e)||void 0})},e.prototype.getCptsByKey=function(t,e){return this.getCpts(t,function(t){var o=t.getComponent(p.default);return!(!o||o.key!=e)||!(!t.key||t.key!=e)||void 0})},e.prototype.getPrefab=function(t){var e=this.getComponent(s.default);if(e)for(var o=0,n=e.config;o<n.length;o++){var r=n[o];if(r.name==t)return r}else cc.warn("\u6ca1\u6709\u53d1\u73b0\u9884\u5236\u4f53\u914d\u7f6e\u7ec4\u4ef6")},i([u],e)}(cc.Component));o.default=f,cc._RF.pop()},{"./KeyCpt":"KeyCpt","./PrefabCfgCpt":"PrefabCfgCpt","./System":"System"}],use_reversed_rotateBy:[function(t,e){"use strict";cc._RF.push(e,"6e9c2OQXSFJQ4RpmZY3gxzK","use_reversed_rotateBy"),cc.RotateBy._reverse=!0,cc._RF.pop()},{}]},{},["CardBaseCpt","CardLayoutCpt","CardTownGameWorld","MoraleCpt","AnimCpt","BrickCpt","BrickInfoCpt","DropEffectCpt","GameConfigCpt","GameMapCpt","GameMapItem","GameWorld","GoldCpt","HeroCpt","MonsterCpt","OprViewCpt","RoleCpt","IslandWorld","ButtonEventCpt","DialogCpt","IdCpt","PopupCpt","PopupScaleInCpt","ResidentCpt","AnimSystem","AudioCfgCpt","BtnEvtCpt","KeyCpt","PrefabCfgCpt","System","TabbarEvtCpt","ToggleEvtCpt","World","EventCpt","EventManager","FSM","PopupManager","ToastManager","Tools","use_reversed_rotateBy"]);